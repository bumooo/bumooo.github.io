---
title: "아이템24 : 멤버 클래스는 되도록 static으로 만들라"
author: bumoo
date: 2023-02-19 02:50:00 +0900
categories: [이펙티브 자바]
tags: [이펙티브 자바]
---

## 중첩 클래스

중첩 클래스란 다른 클래스 안에 정의된 클래스이다. 중첩 클래스는 자신을 감싼 바깥 클래스에서만 쓰여야 하고, 그 외의 쓰임새가 있으면 톱레벨 클래스로 만들어야 한다.

중첩 클래스의 종류는 정적 멤버 클래스, 비정적 멤버 클래스, 익명 클래스, 지역 클래스로 4가지이다.

## 정적 멤버 클래스
흔히 바깥 클래스와 함께 쓰일 때만 유용한 `public 도우미 클래스`로 쓰인다.

## 비정적 멤버 클래스
정적 멤버 클래스와 구문상 `static의 유무`지만, 의미상 차이는 크다.
비정적 멤버 클래스의 인스턴스는 바깥 클래스의 인스턴스와 암묵적으로 연결이 된다.

개념상 중첩 클래스의 인스턴스가 바깥 인스턴스와 독립적으로 존재할 수 있다면 정적 멤버 클래스로 만들어야 한다.
비정적 멤버 클래스는 바깥 인스턴스 없이는 생성할 수 없기 때문이다. 

비정적 멤버 클래스는 어댑터를 정의할 때 자주 쓰인다. 즉, 어떤 클래스의 인스턴스를 감싸 마친 다른 클래스의 인스턴스처럼 보이게 하는 뷰로 사용하는 것이다.

```java
public class MySet<E> extends AbstractSet<E> {
    ... // 생략

    @Override
    public Iterator<E> iterator() {
        return new MyIterator();
    }

    private class MyIterator implements Iterator<E> {
        ...
    }
}
```

위 예시처럼 자신의 반복자를 구현할 때 사용된다.
**멤버 클래스에서 바깥 인스턴스에 접근할 일이 없다면 무조건 `static`을 붙혀서 정적 멤버 클래스로 만들자.**

`static`을 생략하면, 바깥 인스턴스로의 숨은 외부 참조를 갖게 된다. 해당 참조를 저장하려면 시간, 공간이 소비된다.
내부 클래스로 인해 바깥 클래스의 인스턴스를 수거하지 못하는 메모리 누수가 생길 수 있다.

## private 정적 멤버 클래스
흔히 바깥 클래스가 표현하는 객체의 한 부분(구성요소)을 나타낼 때 사용된다.

Map 인스턴스의 경우 키-값을 Entry 객체들이 가지고 있다. Entry의 메소드들(getKey, getValue)은 Map을 직접 사용하지 않아, 비정적 멤버 클래스로는 낭비이다.

## 익명 클래스
익명 클래스는 이름도 없고, 바깥 클래스의 멤버도 아니다. 쓰이는 시점에 선언과 동시에 인스턴스가 만들어진다.

또한 익명 클래스는 제약이 많다. 선언 지점에서만 인스턴스를 생성할 수 있고, **instanceof 검사**나 **클래스의 이름이 필요한 작업**은 수행할 수 없다.

대부분 즉석에서 작은 함수 객체나 처리 객체를 만드는 데 사용했었다. 이제는 람다가 대체한다. 또 다른 쓰임은 정적 팩토리 메소드를 구현할 때이다.

## 지역 클래스
지역변수를 선언할 수 있는 곳이면 어디서든 선언할 수 있고, 유효 범위도 지역변수와 같다.