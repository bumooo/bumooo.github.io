---
title: "아이템59 : 라이브러리를 익히고 사용하라"
author: bumoo
date: 2023-05-05 19:08:00 +0900
categories: [이펙티브 자바]
tags: [이펙티브 자바]
---

## 라이브러리를 익혀야 하는 이유

무작위 정수 하나를 생성하는 코드를 보자.

```java
static Random rnd = new Random();

static int random(int n) {
    return Math.abs(rnd.nextInt()) % n;
}
```

문제가 3 가지나 있다.

**첫 째, `n`이 그리 크지 않은 2의 제곱수라면 같은 수열이 반복된다.**

**둘 째, `n`이 2의 제곱수가 아니라면 몇몇 숫자가 평균적으로 자주 반환한다. `n`이 커면 더 두드러진다.**

다음 코드는 무작위 수를 100만 개 생성하여, 중간 값보다 작은 수의 개수를 출력하는 것이다.

```java
public static void main(String[] args) {
    int n = 2 * (Integer.MAX_VALUE / 3);
    int low = 0;
    for (int i = 0; i < 1000000; i++)
        if (random(n) < n / 2)
            low++;
    System.out.println(low);
}
```

이상적 값은 50만 개가 출력되야 하지만, 666,666에 가까운 값을 얻는다.

**셋 째, 지정한 범위 '바깥'의 수가 종종 튀어나올 수 있다.**

`rnd.nextInt()`를 통해 `Integer.MIN_VALUE`를 반환하면 `Math.abs`도 `Integer.MIN_VALUE`를 반환하여, 음수를 반환한다.

해당 결함을 해결하기 위해 의사난수 생성기, 정수론, 2의 보수 계산 등 알아야 할 것이 많다.

하지만, 이미 `Random.nextInt(int)`가 해결해놨다.

## 표준 라이브러리를 사용해야 하는 이유

첫 째, **표준 라이브러리를 사용하면 그 코드를 작성한 전문가의 지식과 여러분보다 앞서 사용한 다른 프로그래머들의 경험을 활용할 수 있다.**

이미 많은 검증을 통해 `Random.nextInt(int)`가 잘 동작함을 검증했다. 또한 많은 개발자가 사용했지만 버그가 보고된적이 없다고 한다.

둘 째, **핵심적인 일과 크게 관련 없는 문제를 해결하느라 시간을 허비하지 않아도 된다.**

프로그래머들은 하부 공사보단 애플리케이션 기능 개발에 집중하고 싶어할 것이다.

셋 째, **따로 노력하지 않아도 성능이 지속해서 개선이 된다.**

사용자가 많고, 표준 벤치마크를 사용해 성능을 확인하기 때문에 더 나은 방법을 꾸준히 모색할 수 밖에 없다.

넷 째, **기능이 점점 많아진다.**

라이브러리에 부족한 부분이 있으면 커뮤니티에 말이 나와 논의된 후 기능이 추가될 것이다.

다섯 째, **작성한 코드가 많은 사람에게 낯익은 코드가 된다.**

자연스럽게 다른 개발자들이 읽기 쉽고, 유지보수하기 좋고, 재활용하기 쉬운 코드가 된다.

이상의 이점으로는 표준 라이브러리의 기능을 사용하는 것이 좋아보이지만, 실상은 직접 구현해 사용한다.

왜냐하면 라이브러리에 해당 기능이 있는지 모르기 때문이다.

**메이저 릴리스마다 주목할 만한 수많은 기능이 라이브러리에 추가된다.**

예시로 지정한 URL의 내용을 가져오는 명령줄 애플리케이션을 작성해보겠다.(리눅스의 `curl` 명령어)

이전엔 까다로운 기능이었지만, 자바 9에 추가된 `InputStream`의 `transferTo`를 통해 쉽게 구현할 수 있다.

```java
public static void main(String[] args) throws IOException {
    try (InputStream in = new URL(args[0]).openStream()) {
        in.transferTo(System.out);
    }
}
```

**자바 프로그래머라면 `java.lang`, `java.util`, `java.io`와 그 하위 패키지에는 익숙해져야 한다.**

추가로 익히면 좋은 라이브러리로 컬렉션 프레임워크와 스트림 라이브러리가 있다.

또한, `java.util.concurrent`의 동시성 기능도 마찬가지다. 

이 패키지는 멀티스레드 프로그래밍 작업을 단순화해주는 고수준의 편의 기능과 자신만의 고수준 개념을 직접 구현할 수 있도록 도와주는 저수준 요소도 제공한다.
