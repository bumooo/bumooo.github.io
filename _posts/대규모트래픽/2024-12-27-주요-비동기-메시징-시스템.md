---
title: "주요 비동기 메시징 시스템"
author: bumoo
date: 2024-12-27 01:05:00 +0900
categories: ["대규모 트래픽"]
tags: ["비동기 메시징 시스템"]
---

## Apache Kafka
![Apache Kafka](https://github.com/user-attachments/assets/bfa90cab-2fd2-4f3b-af0b-05f86fe4e2a0)

1. 분산 처리
  - 클러스터로 구성되어 대규모 데이터를 분산 처리하며, 수평적 확장 가능
2. 높은 처리량과 지연 시간 최소화
  - 고속의 데이터 처리량 제공, 실시간 데이터 스트리밍 처리 매우 적합
3. 토픽(Topic) 기반 구조
  - **Producer**가 특정 토픽에 메시지 게시하면, 구독한 여러 `Consumer`가 동시에 처리할 수 있음
4. 순서 보장
  - 각 파티션 내에서 메시지의 순서를 보장하며, 메시지 손실 없이 내구성을 보장하는 로그 저장 방식
5. 내구성 보장
  - 데이터를 디스크에 저장하며, 메시지의 손실을 방지하기 위해 복제(replication) 지원

사용 예시 : 실시간 로그 분석, 데이터 스트리밍, 이벤트 소싱

## Rabbit MQ
![Rabbit MQ](https://github.com/user-attachments/assets/049c13e9-87d3-4c86-bc56-9cd102e9bf4d)

1. 큐 기반 구조
  - 프로듀서가 메시지를 큐에 넣고, 컨슈머가 그 큐에서 메시지를 가져가 처리하는 방식
2. 메시지 라우팅
  - 메시지 라우팅 옵션(Direct Exchange, Fanout Exchange, Topic Exchange)을 제공하여 특정 조건에 맞는 메시지를 큐로 전달
3. 스케줄링 및 우선 순위 메시징
  - 메시지에 우선순위를 설정할 수 있으며, 메시지의 스케줄링도 지원
4. 내구성 있는 메시지 저장
  - 메시지를 디스크에 저장하여 시스템 장애 발생 시에도 메시지 손실을 방지
5. 확장성
  - 클러스터링을 통해 확장할 수 있으며, 분산 처리 환경에서 높은 가용성을 제공

사용 예시 : 금융 서비스, 거래 시스템 등에서 메시지 안전한 전달이 필요한 경우

## Amazon SQS (Simple Queue Service)

1. 완전 관리형 서비스
  - AWS가 시스템을 관리하여 사용자는 서비스 구축에 집중
2. 자동 확장
- 트래픽에 따라 자동으로 확장. 대규모 메시지 트래픽을 처리할 때 추가적인 설정 없이 시스템이 자동으로 대응
3. 메시지 전달 보장
- `Rabbit MQ`, `Kafka` 처럼 At least once 방식이 기본으로 제공되며, FIFO 큐를 선택하면 메시지의 순서를 보장
4. 지연 큐
  - 메시지를 일정 시간 동안 대기시킨 후 처리할 수 있는 지연 큐(Delay Queue) 기능을 제공
5. 비용 효율성
  - 클라우드 기반 서비스로 사용한 만큼만 비용 지불

> At least Once 방식 : 최소 1번 메시지를 전달하는 방식
{: .prompt-info }

## 메시징 시스템 선택 시 고려사항
- 처리 속도 : 메시징 시스템의 처리 속도는 시스템의 성능을 결정 요소
  - 높은 처리량이 필요한 경우는 `Kafka`, 높은 신뢰성과 정밀한 메시지 전달이 중요한 경우는 `Rabbit MQ`
- 메시지 전달 보장 : 반드시 한 번 전달되는지, 최소 한 번 전달되는지, 적어도 한 번 이상 전달될 수 있는지
- 확장성 : 시스템이 부하가 늘어났을 때 대응할 수 있는 능력
- 사용 사례에 맞는 기능
  - `Rabbit MQ` : 메시지 라우팅 기능이 뛰어남
  - `Kafka` : 로그 기반의 메시징 처리 최적화
  - `AWS SQS`는 손쉬운 클라우드 관리형 서비스 제공

